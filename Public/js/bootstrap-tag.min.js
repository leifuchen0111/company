!function(a){var c=function(d,e){this.element=a(d);this.options=a.extend(true,{},a.fn.tag.defaults,e);this.values=a.grep(a.map(this.element.val().split(","),a.trim),function(f){return f.length>0});this.show()};c.prototype={constructor:c,show:function(){var j=this;j.element.parent().prepend(j.element.detach().attr("type","hidden"));j.element.wrap(a('<div class="tags '+(j.options.containerClasses?j.options.containerClasses:"")+'">')).parent().on("click",function(){j.input.focus()});if(j.values.length){a.each(j.values,function(){j.createBadge(this)})}j.input=a('<input type="text" class="'+(j.options.inputClasses?j.options.inputClasses:"")+'">').attr("placeholder",j.options.placeholder).insertAfter(j.element).on("focus",function(){j.element.parent().addClass("tags-hover")}).on("blur",function(){j.process();j.element.parent().removeClass("tags-hover");j.element.siblings(".tag").removeClass("tag-important")}).on("keydown",function(m){if(m.keyCode==188||m.keyCode==13||m.keyCode==9){if(a.trim(a(this).val())&&(!j.element.siblings(".typeahead").length||j.element.siblings(".typeahead").is(":hidden"))){if(m.keyCode!=9){m.preventDefault()}j.process()}else{if(m.keyCode==188){if(!j.element.siblings(".typeahead").length||j.element.siblings(".typeahead").is(":hidden")){m.preventDefault()}else{j.input.data("typeahead").select();m.stopPropagation();m.preventDefault()}}}}else{if(!a.trim(a(this).val())&&m.keyCode==8){var l=j.element.siblings(".tag").length;if(l){var n=j.element.siblings(".tag:eq("+(l-1)+")");if(n.hasClass("tag-important")){j.remove(l-1)}else{n.addClass("tag-important")}}}else{j.element.siblings(".tag").removeClass("tag-important")}}}).typeahead({source:j.options.source,matcher:function(l){return ~l.toLowerCase().indexOf(this.query.toLowerCase())&&(j.inValues(l)==-1||j.options.allowDuplicates)},updater:a.proxy(j.add,j)});if(j.options.autosizedInput){var f=j.input,h=j.options.minWidth||f.width(),g=j.options.maxWidth||f.closest(".tags").width(),e=10,k="",i=a("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",paddingLeft:f.css("paddingLeft"),paddingRight:f.css("paddingRight"),fontSize:f.css("fontSize"),fontFamily:f.css("fontFamily"),fontWeight:f.css("fontWeight"),letterSpacing:f.css("letterSpacing"),whiteSpace:"nowrap"}),d=function(){if(k===(k=f.val())){return}var m=k.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");i.html(m);var p=i.width(),o=(p+e)>=h?p+e:h,l=f.width(),n=(o<l&&o>=h)||(o>h&&o<g);if(n){f.width(o)}};i.insertAfter(f);f.bind("keydown keyup blur update",d)}},inValues:function(e){if(this.options.caseInsensitive){var d=-1;a.each(this.values,function(f,g){if(g.toLowerCase()==e.toLowerCase()){d=f;return false}});return d}else{return a.inArray(e,this.values)}},createBadge:function(e){var d=this;a('<span class="tag">').text(e).append(a('<button type="button" class="close"></button>').on("click",function(){d.remove(d.element.siblings(".tag").index(a(this).closest(".tag")))})).insertBefore(d.element)},add:function(g){var f=this;if(!f.options.allowDuplicates){var e=f.inValues(g);if(e!=-1){var d=f.element.siblings(".tag:eq("+e+")");d.addClass("tag-warning");setTimeout(function(){a(d).removeClass("tag-warning")},500);return}}this.values.push(g);this.createBadge(g);this.element.val(this.values.join(", "))},remove:function(d){if(d>=0){this.values.splice(d,1);this.element.siblings(".tag:eq("+d+")").remove();this.element.val(this.values.join(", "))}},process:function(){var e=a.grep(a.map(this.input.val().split(","),a.trim),function(f){return f.length>0}),d=this;a.each(e,function(){d.add(this)});this.input.val("")}};var b=a.fn.tag;a.fn.tag=function(d){return this.each(function(){var g=a(this),e=g.data("tag"),f=typeof d=="object"&&d;if(!e){g.data("tag",(e=new c(this,f)))}if(typeof d=="string"){e[d]()}})};a.fn.tag.defaults={allowDuplicates:false,caseInsensitive:true,placeholder:"",source:[]};a.fn.tag.Constructor=c;a.fn.tag.noConflict=function(){a.fn.tag=b;return this};a(window).on("load",function(){a('[data-provide="tag"]').each(function(){var d=a(this);if(d.data("tag")){return}d.tag(d.data())})})}(window.jQuery);