/*
 * GMaps.js v0.4.3
 * http://hpneo.github.com/gmaps/
 *
 * Copyright 2012, Gustavo Leon
 * Released under the MIT License.
*/
if(window.google==undefined&&window.google.maps==undefined){throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."}var extend_object=function(c,b){var a;if(c===b){return c}for(a in b){c[a]=b[a]}return c};var replace_object=function(b,c){var a;if(b===c){return b}for(a in c){if(b[a]!=undefined){b[a]=c[a]}}return b};var array_map=function(a,d){var g=Array.prototype.slice.call(arguments,2),c=[],b=a.length,f;if(Array.prototype.map&&a.map===Array.prototype.map){c=Array.prototype.map.call(a,function(h){callback_params=g;callback_params.splice(0,0,h);return d.apply(this,callback_params)})}else{for(f=0;f<b;f++){callback_params=g;callback_params=callback_params.splice(0,0,a[f]);c.push(d.apply(this,callback_params))}}return c};var array_flat=function(a){var c=[],b;for(b=0;b<a.length;b++){c=c.concat(a[b])}return c};var coordsToLatLngs=function(a,d){var b=a[0],c=a[1];if(d){b=a[1];c=a[0]}return new google.maps.LatLng(b,c)};var arrayToLatLng=function(a,c){var b;for(b=0;b<a.length;b++){if(a[b].length>0&&typeof(a[b][0])!="number"){a[b]=arrayToLatLng(a[b],c)}else{a[b]=coordsToLatLngs(a[b],c)}}return a};var getElementById=function(c,a){var b,c=c.replace("#","");if("jQuery" in this&&a){b=$("#"+c,a)[0]}else{b=document.getElementById(c)}return b};var findAbsolutePosition=function(c){var a=0,b=0;if(c.offsetParent){do{a+=c.offsetLeft;b+=c.offsetTop}while(c=c.offsetParent)}return[a,b]};var GMaps=(function(b){var a=document;var c=function(w){w.zoom=w.zoom||15;w.mapType=w.mapType||"roadmap";var B=this,l,k=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],j=["mousemove","mouseout","mouseover"],x=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],g=w.el||w.div,s=w.markerClusterer,q=google.maps.MapTypeId[w.mapType.toUpperCase()],n=new google.maps.LatLng(w.lat,w.lng),E=w.zoomControl||true,F=w.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},H=F.style||"DEFAULT",G=F.position||"TOP_LEFT",z=w.panControl||true,r=w.mapTypeControl||true,A=w.scaleControl||true,D=w.streetViewControl||true,y=y||true,p={},m={zoom:this.zoom,center:n,mapTypeId:q},o={panControl:z,zoomControl:E,zoomControlOptions:{style:google.maps.ZoomControlStyle[H],position:google.maps.ControlPosition[G]},mapTypeControl:r,scaleControl:A,streetViewControl:D,overviewMapControl:y};if(typeof(w.el)==="string"||typeof(w.div)==="string"){this.el=getElementById(g,w.context)}else{this.el=g}if(typeof(this.el)==="undefined"||this.el===null){throw"No element defined."}window.context_menu=window.context_menu||{};window.context_menu[B.el.id]={};this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=w.zoom;this.registered_events={};this.el.style.width=w.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=w.height||this.el.scrollHeight||this.el.offsetHeight;google.maps.visualRefresh=w.enableNewStyle;for(l=0;l<x.length;l++){delete w[x[l]]}if(w.disableDefaultUI!=true){m=extend_object(m,o)}p=extend_object(m,w);for(l=0;l<k.length;l++){delete p[k[l]]}for(l=0;l<j.length;l++){delete p[j[l]]}this.map=new google.maps.Map(this.el,p);if(s){this.markerClusterer=s.apply(this,[this.map])}var f=function(N,O){var P="",T=window.context_menu[B.el.id][N];for(var Q in T){if(T.hasOwnProperty(Q)){var S=T[Q];P+='<li><a id="'+N+"_"+Q+'" href="#">'+S.title+"</a></li>"}}if(!getElementById("gmaps_context_menu")){return}var J=getElementById("gmaps_context_menu");J.innerHTML=P;var L=J.getElementsByTagName("a"),M=L.length;Q;for(Q=0;Q<M;Q++){var K=L[Q];var I=function(i){i.preventDefault();T[this.id.replace(N+"_","")].action.apply(B,[O]);B.hideContextMenu()};google.maps.event.clearListeners(K,"click");google.maps.event.addDomListenerOnce(K,"click",I,false)}var U=findAbsolutePosition.apply(this,[B.el]),R=U[0]+O.pixel.x-15,V=U[1]+O.pixel.y-15;J.style.left=R+"px";J.style.top=V+"px";J.style.display="block"};var d=function(i,I){if(i==="marker"){I.pixel={};var J=new google.maps.OverlayView();J.setMap(B.map);J.draw=function(){var L=J.getProjection(),K=I.marker.getPosition();I.pixel=L.fromLatLngToContainerPixel(K);f(i,I)}}else{f(i,I)}};this.setContextMenu=function(L){window.context_menu[B.el.id][L.control]={};var J,M=a.createElement("ul");for(J in L.options){if(L.options.hasOwnProperty(J)){var K=L.options[J];window.context_menu[B.el.id][L.control][K.name]={title:K.title,action:K.action}}}M.id="gmaps_context_menu";M.style.display="none";M.style.position="absolute";M.style.minWidth="100px";M.style.background="white";M.style.listStyle="none";M.style.padding="8px";M.style.boxShadow="2px 2px 6px #ccc";a.body.appendChild(M);var I=getElementById("gmaps_context_menu");google.maps.event.addDomListener(I,"mouseout",function(i){if(!i.relatedTarget||!this.contains(i.relatedTarget)){window.setTimeout(function(){I.style.display="none"},400)}},false)};this.hideContextMenu=function(){var i=getElementById("gmaps_context_menu");if(i){i.style.display="none"}};var C=function(I,i){google.maps.event.addListener(I,i,function(J){if(J==undefined){J=this}w[i].apply(this,[J]);B.hideContextMenu()})};for(var h=0;h<k.length;h++){var u=k[h];if(u in w){C(this.map,u)}}for(var h=0;h<j.length;h++){var u=j[h];if(u in w){C(this.map,u)}}google.maps.event.addListener(this.map,"rightclick",function(i){if(w.rightclick){w.rightclick.apply(this,[i])}if(window.context_menu[B.el.id]["map"]!=undefined){d("map",i)}});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){var J=[],K=this.markers.length,I;for(I=0;I<K;I++){J.push(this.markers[I].getPosition())}this.fitLatLngBounds(J)};this.fitLatLngBounds=function(K){var L=K.length;var I=new google.maps.LatLngBounds();for(var J=0;J<L;J++){I.extend(K[J])}this.map.fitBounds(I)};this.setCenter=function(I,J,i){this.map.panTo(new google.maps.LatLng(I,J));if(i){i()}};this.getElement=function(){return this.el};this.zoomIn=function(i){i=i||1;this.zoom=this.map.getZoom()+i;this.map.setZoom(this.zoom)};this.zoomOut=function(i){i=i||1;this.zoom=this.map.getZoom()-i;this.map.setZoom(this.zoom)};var v=[],t;for(t in this.map){if(typeof(this.map[t])=="function"&&!this[t]){v.push(t)}}for(l=0;l<v.length;l++){(function(i,J,I){i[I]=function(){return J[I].apply(J,arguments)}})(this,this.map,v[l])}};return c})(this);GMaps.prototype.createControl=function(d){var a=document.createElement("div");a.style.cursor="pointer";a.style.fontFamily="Arial, sans-serif";a.style.fontSize="13px";a.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";for(var c in d.style){a.style[c]=d.style[c]}if(d.id){a.id=d.id}if(d.classes){a.className=d.classes}if(d.content){a.innerHTML=d.content}for(var b in d.events){(function(g,f){google.maps.event.addDomListener(g,f,function(){d.events[f].apply(this,[this])})})(a,b)}a.index=1;return a};GMaps.prototype.addControl=function(b){var c=google.maps.ControlPosition[b.position.toUpperCase()];delete b.position;var a=this.createControl(b);this.controls.push(a);this.map.controls[c].push(a);return a};GMaps.prototype.createMarker=function(k){if(k.lat==undefined&&k.lng==undefined&&k.position==undefined){throw"No latitude or longitude defined."}var m=this,b=k.details,d=k.fences,l=k.outside,a={position:new google.maps.LatLng(k.lat,k.lng),map:null};delete k.lat;delete k.lng;delete k.fences;delete k.outside;var j=extend_object(a,k),g=new google.maps.Marker(j);g.fences=d;if(k.infoWindow){g.infoWindow=new google.maps.InfoWindow(k.infoWindow);var f=["closeclick","content_changed","domready","position_changed","zindex_changed"];for(var c=0;c<f.length;c++){(function(o,n){if(k.infoWindow[n]){google.maps.event.addListener(o,n,function(p){k.infoWindow[n].apply(this,[p])})}})(g.infoWindow,f[c])}}var h=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"];var i=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"];for(var c=0;c<h.length;c++){(function(o,n){if(k[n]){google.maps.event.addListener(o,n,function(){k[n].apply(this,[this])})}})(g,h[c])}for(var c=0;c<i.length;c++){(function(n,p,o){if(k[o]){google.maps.event.addListener(p,o,function(q){if(!q.pixel){q.pixel=n.getProjection().fromLatLngToPoint(q.latLng)}k[o].apply(this,[q])})}})(this.map,g,i[c])}google.maps.event.addListener(g,"click",function(){this.details=b;if(k.click){k.click.apply(this,[this])}if(g.infoWindow){m.hideInfoWindows();g.infoWindow.open(m.map,g)}});google.maps.event.addListener(g,"rightclick",function(n){n.marker=this;if(k.rightclick){k.rightclick.apply(this,[n])}if(window.context_menu[m.el.id]["marker"]!=undefined){buildContextMenu("marker",n)}});if(g.fences){google.maps.event.addListener(g,"dragend",function(){m.checkMarkerGeofence(g,function(o,n){l(o,n)})})}return g};GMaps.prototype.addMarker=function(b){var a;if(b.hasOwnProperty("gm_accessors_")){a=b}else{if((b.hasOwnProperty("lat")&&b.hasOwnProperty("lng"))||b.position){a=this.createMarker(b)}else{throw"No latitude or longitude defined."}}a.setMap(this.map);if(this.markerClusterer){this.markerClusterer.addMarker(a)}this.markers.push(a);GMaps.fire("marker_added",a,this);return a};GMaps.prototype.addMarkers=function(a){for(var b=0,c;c=a[b];b++){this.addMarker(c)}return this.markers};GMaps.prototype.hideInfoWindows=function(){for(var a=0,b;b=this.markers[a];a++){if(b.infoWindow){b.infoWindow.close()}}};GMaps.prototype.removeMarker=function(b){for(var a=0;a<this.markers.length;a++){if(this.markers[a]===b){this.markers[a].setMap(null);this.markers.splice(a,1);GMaps.fire("marker_removed",b,this);break}}return b};GMaps.prototype.removeMarkers=function(a){var a=(a||this.markers);for(var b=0;b<this.markers.length;b++){if(this.markers[b]===a[b]){this.markers[b].setMap(null)}}var c=[];for(var b=0;b<this.markers.length;b++){if(this.markers[b].getMap()!=null){c.push(this.markers[b])}}this.markers=c};GMaps.prototype.drawOverlay=function(b){var c=new google.maps.OverlayView(),a=true;c.setMap(this.map);if(b.auto_show!=null){a=b.auto_show}c.onAdd=function(){var d=document.createElement("div");d.style.borderStyle="none";d.style.borderWidth="0px";d.style.position="absolute";d.style.zIndex=100;d.innerHTML=b.content;c.el=d;if(!b.layer){b.layer="overlayLayer"}var h=this.getPanes(),g=h[b.layer],i=["contextmenu","DOMMouseScroll","dblclick","mousedown"];g.appendChild(d);for(var f=0;f<i.length;f++){(function(k,j){google.maps.event.addDomListener(k,j,function(l){if(navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&document.all){l.cancelBubble=true;l.returnValue=false}else{l.stopPropagation()}})})(d,i[f])}google.maps.event.trigger(this,"ready")};c.draw=function(){var j=this.getProjection(),i=j.fromLatLngToDivPixel(new google.maps.LatLng(b.lat,b.lng));b.horizontalOffset=b.horizontalOffset||0;b.verticalOffset=b.verticalOffset||0;var h=c.el,d=h.children[0],f=d.clientHeight,g=d.clientWidth;switch(b.verticalAlign){case"top":h.style.top=(i.y-f+b.verticalOffset)+"px";break;default:case"middle":h.style.top=(i.y-(f/2)+b.verticalOffset)+"px";break;case"bottom":h.style.top=(i.y+b.verticalOffset)+"px";break}switch(b.horizontalAlign){case"left":h.style.left=(i.x-g+b.horizontalOffset)+"px";break;default:case"center":h.style.left=(i.x-(g/2)+b.horizontalOffset)+"px";break;case"right":h.style.left=(i.x+b.horizontalOffset)+"px";break}h.style.display=a?"block":"none";if(!a){b.show.apply(this,[h])}};c.onRemove=function(){var d=c.el;if(b.remove){b.remove.apply(this,[d])}else{c.el.parentNode.removeChild(c.el);c.el=null}};this.overlays.push(c);return c};GMaps.prototype.removeOverlay=function(b){for(var a=0;a<this.overlays.length;a++){if(this.overlays[a]===b){this.overlays[a].setMap(null);this.overlays.splice(a,1);break}}};GMaps.prototype.removeOverlays=function(){for(var a=0,b;b=this.overlays[a];a++){b.setMap(null)}this.overlays=[]};GMaps.prototype.drawPolyline=function(d){var f=[],g=d.path;if(g.length){if(g[0][0]===undefined){f=g}else{for(var b=0,c;c=g[b];b++){f.push(new google.maps.LatLng(c[0],c[1]))}}}var k={map:this.map,path:f,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeWeight:d.strokeWeight,geodesic:d.geodesic,clickable:true,editable:false,visible:true};if(d.hasOwnProperty("clickable")){k.clickable=d.clickable}if(d.hasOwnProperty("editable")){k.editable=d.editable}if(d.hasOwnProperty("icons")){k.icons=d.icons}if(d.hasOwnProperty("zIndex")){k.zIndex=d.zIndex}var h=new google.maps.Polyline(k);var j=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var a=0;a<j.length;a++){(function(l,i){if(d[i]){google.maps.event.addListener(l,i,function(m){d[i].apply(this,[m])})}})(h,j[a])}this.polylines.push(h);GMaps.fire("polyline_added",h,this);return h};GMaps.prototype.removePolyline=function(b){for(var a=0;a<this.polylines.length;a++){if(this.polylines[a]===b){this.polylines[a].setMap(null);this.polylines.splice(a,1);GMaps.fire("polyline_removed",b,this);break}}};GMaps.prototype.removePolylines=function(){for(var a=0,b;b=this.polylines[a];a++){b.setMap(null)}this.polylines=[]};GMaps.prototype.drawCircle=function(b){b=extend_object({map:this.map,center:new google.maps.LatLng(b.lat,b.lng)},b);delete b.lat;delete b.lng;var c=new google.maps.Circle(b),d=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var a=0;a<d.length;a++){(function(g,f){if(b[f]){google.maps.event.addListener(g,f,function(h){b[f].apply(this,[h])})}})(c,d[a])}this.polygons.push(c);return c};GMaps.prototype.drawRectangle=function(c){c=extend_object({map:this.map},c);var b=new google.maps.LatLngBounds(new google.maps.LatLng(c.bounds[0][0],c.bounds[0][1]),new google.maps.LatLng(c.bounds[1][0],c.bounds[1][1]));c.bounds=b;var d=new google.maps.Rectangle(c),f=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var a=0;a<f.length;a++){(function(h,g){if(c[g]){google.maps.event.addListener(h,g,function(i){c[g].apply(this,[i])})}})(d,f[a])}this.polygons.push(d);return d};GMaps.prototype.drawPolygon=function(b){var f=false;if(b.hasOwnProperty("useGeoJSON")){f=b.useGeoJSON}delete b.useGeoJSON;b=extend_object({map:this.map},b);if(f==false){b.paths=[b.paths.slice(0)]}if(b.paths.length>0){if(b.paths[0].length>0){b.paths=array_flat(array_map(b.paths,arrayToLatLng,f))}}var c=new google.maps.Polygon(b),d=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var a=0;a<d.length;a++){(function(h,g){if(b[g]){google.maps.event.addListener(h,g,function(i){b[g].apply(this,[i])})}})(c,d[a])}this.polygons.push(c);GMaps.fire("polygon_added",c,this);return c};GMaps.prototype.removePolygon=function(b){for(var a=0;a<this.polygons.length;a++){if(this.polygons[a]===b){this.polygons[a].setMap(null);this.polygons.splice(a,1);GMaps.fire("polygon_removed",b,this);break}}};GMaps.prototype.removePolygons=function(){for(var a=0,b;b=this.polygons[a];a++){b.setMap(null)}this.polygons=[]};GMaps.prototype.getFromFusionTables=function(f){var b=f.events;delete f.events;var c=f,d=new google.maps.FusionTablesLayer(c);for(var a in b){(function(h,g){google.maps.event.addListener(h,g,function(i){b[g].apply(this,[i])})})(d,a)}this.layers.push(d);return d};GMaps.prototype.loadFromFusionTables=function(b){var a=this.getFromFusionTables(b);a.setMap(this.map);return a};GMaps.prototype.getFromKML=function(f){var g=f.url,b=f.events;delete f.url;delete f.events;var c=f,d=new google.maps.KmlLayer(g,c);for(var a in b){(function(i,h){google.maps.event.addListener(i,h,function(j){b[h].apply(this,[j])})})(d,a)}this.layers.push(d);return d};GMaps.prototype.loadFromKML=function(b){var a=this.getFromKML(b);a.setMap(this.map);return a};GMaps.prototype.addLayer=function(b,c){c=c||{};var a;switch(b){case"weather":this.singleLayers.weather=a=new google.maps.weather.WeatherLayer();break;case"clouds":this.singleLayers.clouds=a=new google.maps.weather.CloudLayer();break;case"traffic":this.singleLayers.traffic=a=new google.maps.TrafficLayer();break;case"transit":this.singleLayers.transit=a=new google.maps.TransitLayer();break;case"bicycling":this.singleLayers.bicycling=a=new google.maps.BicyclingLayer();break;case"panoramio":this.singleLayers.panoramio=a=new google.maps.panoramio.PanoramioLayer();a.setTag(c.filter);delete c.filter;if(c.click){google.maps.event.addListener(a,"click",function(g){c.click(g);delete c.click})}break;case"places":this.singleLayers.places=a=new google.maps.places.PlacesService(this.map);if(c.search||c.nearbySearch){var d={bounds:c.bounds||null,keyword:c.keyword||null,location:c.location||null,name:c.name||null,radius:c.radius||null,rankBy:c.rankBy||null,types:c.types||null};if(c.search){a.search(d,c.search)}if(c.nearbySearch){a.nearbySearch(d,c.nearbySearch)}}if(c.textSearch){var f={bounds:c.bounds||null,location:c.location||null,query:c.query||null,radius:c.radius||null};a.textSearch(f,c.textSearch)}break}if(a!==undefined){if(typeof a.setOptions=="function"){a.setOptions(c)}if(typeof a.setMap=="function"){a.setMap(this.map)}return a}};GMaps.prototype.removeLayer=function(b){if(typeof(b)=="string"&&this.singleLayers[b]!==undefined){this.singleLayers[b].setMap(null);delete this.singleLayers[b]}else{for(var a=0;a<this.layers.length;a++){if(this.layers[a]===b){this.layers[a].setMap(null);this.layers.splice(a,1);break}}}};var travelMode,unitSystem;GMaps.prototype.getRoutes=function(b){switch(b.travelMode){case"bicycling":travelMode=google.maps.TravelMode.BICYCLING;break;case"transit":travelMode=google.maps.TravelMode.TRANSIT;break;case"driving":travelMode=google.maps.TravelMode.DRIVING;break;default:travelMode=google.maps.TravelMode.WALKING;break}if(b.unitSystem==="imperial"){unitSystem=google.maps.UnitSystem.IMPERIAL}else{unitSystem=google.maps.UnitSystem.METRIC}var a={avoidHighways:false,avoidTolls:false,optimizeWaypoints:false,waypoints:[]},c=extend_object(a,b);c.origin=/string/.test(typeof b.origin)?b.origin:new google.maps.LatLng(b.origin[0],b.origin[1]);c.destination=/string/.test(typeof b.destination)?b.destination:new google.maps.LatLng(b.destination[0],b.destination[1]);c.travelMode=travelMode;c.unitSystem=unitSystem;delete c.callback;var d=this,f=new google.maps.DirectionsService();f.route(c,function(h,i){if(i===google.maps.DirectionsStatus.OK){for(var g in h.routes){if(h.routes.hasOwnProperty(g)){d.routes.push(h.routes[g])}}}if(b.callback){b.callback(d.routes)}})};GMaps.prototype.removeRoutes=function(){this.routes=[]};GMaps.prototype.getElevations=function(b){b=extend_object({locations:[],path:false,samples:256},b);if(b.locations.length>0){if(b.locations[0].length>0){b.locations=array_flat(array_map([b.locations],arrayToLatLng,false))}}var a=b.callback;delete b.callback;var d=new google.maps.ElevationService();if(!b.path){delete b.path;delete b.samples;d.getElevationForLocations(b,function(f,g){if(a&&typeof(a)==="function"){a(f,g)}})}else{var c={path:b.locations,samples:b.samples};d.getElevationAlongPath(c,function(f,g){if(a&&typeof(a)==="function"){a(f,g)}})}};GMaps.prototype.cleanRoute=GMaps.prototype.removePolylines;GMaps.prototype.drawRoute=function(a){var b=this;this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,waypoints:a.waypoints,unitSystem:a.unitSystem,callback:function(c){if(c.length>0){b.drawPolyline({path:c[c.length-1].overview_path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight});if(a.callback){a.callback(c[c.length-1])}}}})};GMaps.prototype.travelRoute=function(b){if(b.origin&&b.destination){this.getRoutes({origin:b.origin,destination:b.destination,travelMode:b.travelMode,waypoints:b.waypoints,callback:function(f){if(f.length>0&&b.start){b.start(f[f.length-1])}if(f.length>0&&b.step){var h=f[f.length-1];if(h.legs.length>0){var k=h.legs[0].steps;for(var g=0,j;j=k[g];g++){j.step_number=g;b.step(j,(h.legs[0].steps.length-1))}}}if(f.length>0&&b.end){b.end(f[f.length-1])}}})}else{if(b.route){if(b.route.legs.length>0){var d=b.route.legs[0].steps;for(var a=0,c;c=d[a];a++){c.step_number=a;b.step(c)}}}}};GMaps.prototype.drawSteppedRoute=function(b){var c=this;if(b.origin&&b.destination){this.getRoutes({origin:b.origin,destination:b.destination,travelMode:b.travelMode,waypoints:b.waypoints,callback:function(g){if(g.length>0&&b.start){b.start(g[g.length-1])}if(g.length>0&&b.step){var j=g[g.length-1];if(j.legs.length>0){var l=j.legs[0].steps;for(var h=0,k;k=l[h];h++){k.step_number=h;c.drawPolyline({path:k.path,strokeColor:b.strokeColor,strokeOpacity:b.strokeOpacity,strokeWeight:b.strokeWeight});b.step(k,(j.legs[0].steps.length-1))}}}if(g.length>0&&b.end){b.end(g[g.length-1])}}})}else{if(b.route){if(b.route.legs.length>0){var f=b.route.legs[0].steps;for(var a=0,d;d=f[a];a++){d.step_number=a;c.drawPolyline({path:d.path,strokeColor:b.strokeColor,strokeOpacity:b.strokeOpacity,strokeWeight:b.strokeWeight});b.step(d)}}}}};GMaps.Route=function(a){this.origin=a.origin;this.destination=a.destination;this.waypoints=a.waypoints;this.map=a.map;this.route=a.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray(),strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight}).getPath()};GMaps.Route.prototype.getRoute=function(a){var b=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:a.travelMode,waypoints:this.waypoints||[],callback:function(){b.route=e[0];if(a.callback){a.callback.call(b)}}})};GMaps.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var b=this.route.legs[0].steps[this.step_count].path;for(var a in b){if(b.hasOwnProperty(a)){this.polyline.pop()}}}};GMaps.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var b=this.route.legs[0].steps[this.step_count].path;for(var a in b){if(b.hasOwnProperty(a)){this.polyline.push(b[a])}}this.step_count++}};GMaps.prototype.checkGeofence=function(b,c,a){return a.containsLatLng(new google.maps.LatLng(b,c))};GMaps.prototype.checkMarkerGeofence=function(c,d){if(c.fences){for(var b=0,a;a=c.fences[b];b++){var f=c.getPosition();if(!this.checkGeofence(f.lat(),f.lng(),a)){d(c,a)}}}};GMaps.prototype.toImage=function(b){var b=b||{},d={};d.size=b.size||[this.el.clientWidth,this.el.clientHeight];d.lat=this.getCenter().lat();d.lng=this.getCenter().lng();if(this.markers.length>0){d.markers=[];for(var a=0;a<this.markers.length;a++){d.markers.push({lat:this.markers[a].getPosition().lat(),lng:this.markers[a].getPosition().lng()})}}if(this.polylines.length>0){var c=this.polylines[0];d.polyline={};d.polyline["path"]=google.maps.geometry.encoding.encodePath(c.getPath());d.polyline["strokeColor"]=c.strokeColor;d.polyline["strokeOpacity"]=c.strokeOpacity;d.polyline["strokeWeight"]=c.strokeWeight}return GMaps.staticMapURL(d)};GMaps.staticMapURL=function(l){var n=[],b,u="http://maps.googleapis.com/maps/api/staticmap";if(l.url){u=l.url;delete l.url}u+="?";var k=l.markers;delete l.markers;if(!k&&l.marker){k=[l.marker];delete l.marker}var q=l.polyline;delete l.polyline;if(l.center){n.push("center="+l.center);delete l.center}else{if(l.address){n.push("center="+l.address);delete l.address}else{if(l.lat){n.push(["center=",l.lat,",",l.lng].join(""));delete l.lat;delete l.lng}else{if(l.visible){var v=encodeURI(l.visible.join("|"));n.push("visible="+v)}}}}var t=l.size;if(t){if(t.join){t=t.join("x")}delete l.size}else{t="630x300"}n.push("size="+t);if(!l.zoom){l.zoom=15}var s=l.hasOwnProperty("sensor")?!!l.sensor:true;delete l.sensor;n.push("sensor="+s);for(var m in l){if(l.hasOwnProperty(m)){n.push(m+"="+l[m])}}if(k){var h,g;for(var d=0;b=k[d];d++){h=[];if(b.size&&b.size!=="normal"){h.push("size:"+b.size)}else{if(b.icon){h.push("icon:"+encodeURI(b.icon))}}if(b.color){h.push("color:"+b.color.replace("#","0x"))}if(b.label){h.push("label:"+b.label[0].toUpperCase())}g=(b.address?b.address:b.lat+","+b.lng);if(h.length||d===0){h.push(g);h=h.join("|");n.push("markers="+encodeURI(h))}else{h=n.pop()+encodeURI("|"+g);n.push(h)}}}function o(i,j){if(i[0]==="#"){i=i.replace("#","0x");if(j){j=parseFloat(j);j=Math.min(1,Math.max(j,0));if(j===0){return"0x00000000"}j=(j*255).toString(16);if(j.length===1){j+=j}i=i.slice(0,8)+j}}return i}if(q){b=q;q=[];if(b.strokeWeight){q.push("weight:"+parseInt(b.strokeWeight,10))}if(b.strokeColor){var a=o(b.strokeColor,b.strokeOpacity);q.push("color:"+a)}if(b.fillColor){var c=o(b.fillColor,b.fillOpacity);q.push("fillcolor:"+c)}var p=b.path;if(p.join){for(var f=0,r;r=p[f];f++){q.push(r.join(","))}}else{q.push("enc:"+p)}q=q.join("|");n.push("path="+encodeURI(q))}n=n.join("&");return u+n};GMaps.prototype.addMapType=function(b,c){if(c.hasOwnProperty("getTileUrl")&&typeof(c.getTileUrl)=="function"){c.tileSize=c.tileSize||new google.maps.Size(256,256);var a=new google.maps.ImageMapType(c);this.map.mapTypes.set(b,a)}else{throw"'getTileUrl' function required."}};GMaps.prototype.addOverlayMapType=function(a){if(a.hasOwnProperty("getTile")&&typeof(a.getTile)=="function"){var b=a.index;delete a.index;this.map.overlayMapTypes.insertAt(b,a)}else{throw"'getTile' function required."}};GMaps.prototype.removeOverlayMapType=function(a){this.map.overlayMapTypes.removeAt(a)};GMaps.prototype.addStyle=function(a){var b=new google.maps.StyledMapType(a.styles,a.styledMapName);this.map.mapTypes.set(a.mapTypeId,b)};GMaps.prototype.setStyle=function(a){this.map.setMapTypeId(a)};GMaps.prototype.createPanorama=function(a){if(!a.hasOwnProperty("lat")||!a.hasOwnProperty("lng")){a.lat=this.getCenter().lat();a.lng=this.getCenter().lng()}this.panorama=GMaps.createPanorama(a);this.map.setStreetView(this.panorama);return this.panorama};GMaps.createPanorama=function(c){var a=getElementById(c.el,c.context);c.position=new google.maps.LatLng(c.lat,c.lng);delete c.el;delete c.context;delete c.lat;delete c.lng;var f=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],g=extend_object({visible:true},c);for(var b=0;b<f.length;b++){delete g[f[b]]}var d=new google.maps.StreetViewPanorama(a,g);for(var b=0;b<f.length;b++){(function(i,h){if(c[h]){google.maps.event.addListener(i,h,function(){c[h].apply(this)})}})(d,f[b])}return d};GMaps.prototype.on=function(a,b){return GMaps.on(a,this,b)};GMaps.prototype.off=function(a){GMaps.off(a,this)};GMaps.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"];GMaps.on=function(a,c,b){if(GMaps.custom_events.indexOf(a)==-1){return google.maps.event.addListener(c,a,b)}else{var d={handler:b,eventName:a};c.registered_events[a]=c.registered_events[a]||[];c.registered_events[a].push(d);return d}};GMaps.off=function(a,b){if(GMaps.custom_events.indexOf(a)==-1){google.maps.event.clearListeners(b,a)}else{b.registered_events[a]=[]}};GMaps.fire=function(a,d,f){if(GMaps.custom_events.indexOf(a)==-1){google.maps.event.trigger(d,a,Array.prototype.slice.apply(arguments).slice(2))}else{if(a in f.registered_events){var b=f.registered_events[a];for(var c=0;c<b.length;c++){(function(g,i,h){g.apply(i,[h])})(b[c]["handler"],f,d)}}}};GMaps.geolocate=function(b){var a=b.always||b.complete;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(c){b.success(c);if(a){a()}},function(c){b.error(c);if(a){a()}},b.options)}else{b.not_supported();if(a){a()}}};GMaps.geocode=function(b){this.geocoder=new google.maps.Geocoder();var a=b.callback;if(b.hasOwnProperty("lat")&&b.hasOwnProperty("lng")){b.latLng=new google.maps.LatLng(b.lat,b.lng)}delete b.lat;delete b.lng;delete b.callback;this.geocoder.geocode(b,function(c,d){a(c,d)})};if(!google.maps.Polygon.prototype.getBounds){google.maps.Polygon.prototype.getBounds=function(c){var a=new google.maps.LatLngBounds();var g=this.getPaths();var f;for(var d=0;d<g.getLength();d++){f=g.getAt(d);for(var b=0;b<f.getLength();b++){a.extend(f.getAt(b))}}return a}}if(!google.maps.Polygon.prototype.containsLatLng){google.maps.Polygon.prototype.containsLatLng=function(f){var a=this.getBounds();if(a!==null&&!a.contains(f)){return false}var c=false;var g=this.getPaths().getLength();for(var k=0;k<g;k++){var l=this.getPaths().getAt(k);var h=l.getLength();var d=h-1;for(var b=0;b<h;b++){var m=l.getAt(b);var n=l.getAt(d);if(m.lng()<f.lng()&&n.lng()>=f.lng()||n.lng()<f.lng()&&m.lng()>=f.lng()){if(m.lat()+(f.lng()-m.lng())/(n.lng()-m.lng())*(n.lat()-m.lat())<f.lat()){c=!c}}d=b}}return c}}google.maps.LatLngBounds.prototype.containsLatLng=function(a){return this.contains(a)};google.maps.Marker.prototype.setFences=function(a){this.fences=a};google.maps.Marker.prototype.addFence=function(a){this.fences.push(a)};google.maps.Marker.prototype.getId=function(){return this["__gm_id"]};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(d){if(this==null){throw new TypeError()}var f=Object(this);var b=f.length>>>0;if(b===0){return -1}var c=0;if(arguments.length>1){c=Number(arguments[1]);if(c!=c){c=0}else{if(c!=0&&c!=Infinity&&c!=-Infinity){c=(c>0||-1)*Math.floor(Math.abs(c))}}}if(c>=b){return -1}var a=c>=0?c:Math.max(b-Math.abs(c),0);for(;a<b;a++){if(a in f&&f[a]===d){return a}}return -1}};