(function(a){a.gritter={};a.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1000,time:6000};a.gritter.add=function(f){try{return b.add(f||{})}catch(c){var d="Gritter Error: "+c;(typeof(console)!="undefined"&&console.error)?console.error(d,f):alert(d)}};a.gritter.remove=function(c,d){b.removeSpecific(c,d||{})};a.gritter.removeAll=function(c){b.stop(c||{})};var b={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(i){if(typeof(i)=="string"){i={text:i}}if(!i.text){throw'You must supply "text" parameter.'}if(!this._is_setup){this._runSetup()}var n=i.title,l=i.text,d=i.image||"",k=i.sticky||false,g=i.class_name||a.gritter.options.class_name,j=a.gritter.options.position,m=i.time||"";this._verifyWrapper();this._item_count++;var h=this._item_count,o=this._tpl_item;a(["before_open","after_open","before_close","after_close"]).each(function(p,q){b["_"+q+"_"+h]=(a.isFunction(i[q]))?i[q]:function(){}});this._custom_timer=0;if(m){this._custom_timer=m}var e=(d!="")?'<img src="'+d+'" class="gritter-image" />':"",c=(d!="")?"gritter-with-image":"gritter-without-image";if(n){n=this._str_replace("[[title]]",n,this._tpl_title)}else{n=""}o=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[n,l,this._tpl_close,e,this._item_count,c,g],o);if(this["_before_open_"+h]()===false){return false}a("#gritter-notice-wrapper").addClass(j).append(o);var f=a("#gritter-item-"+this._item_count);f.fadeIn(this.fade_in_speed,function(){b["_after_open_"+h](a(this))});if(!k){this._setFadeTimer(f,h)}a(f).bind("mouseenter mouseleave",function(p){if(p.type=="mouseenter"){if(!k){b._restoreItemIfFading(a(this),h)}}else{if(!k){b._setFadeTimer(a(this),h)}}b._hoverState(a(this),p.type)});a(f).find(".gritter-close").click(function(){b.removeSpecific(h,{},null,true)});return h},_countRemoveWrapper:function(f,c,d){c.remove();this["_after_close_"+f](c,d);if(a(".gritter-item-wrapper").length==0){a("#gritter-notice-wrapper").remove()}},_fade:function(c,j,h,i){var h=h||{},d=(typeof(h.fade)!="undefined")?h.fade:true,f=h.speed||this.fade_out_speed,g=i;this["_before_close_"+j](c,g);if(i){c.unbind("mouseenter mouseleave")}if(d){c.animate({opacity:0},f,function(){c.animate({height:0},300,function(){b._countRemoveWrapper(j,c,g)})})}else{this._countRemoveWrapper(j,c)}},_hoverState:function(c,d){if(d=="mouseenter"){c.addClass("hover");c.find(".gritter-close").show()}else{c.removeClass("hover");c.find(".gritter-close").hide()}},removeSpecific:function(g,d,c,f){if(!c){var c=a("#gritter-item-"+g)}this._fade(c,g,d||{},f)},_restoreItemIfFading:function(c,d){clearTimeout(this["_int_id_"+d]);c.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in a.gritter.options){this[opt]=a.gritter.options[opt]}this._is_setup=1},_setFadeTimer:function(c,f){var d=(this._custom_timer)?this._custom_timer:this.time;this["_int_id_"+f]=setTimeout(function(){b._fade(c,f)},d)},stop:function(e){var d=(a.isFunction(e.before_close))?e.before_close:function(){};var c=(a.isFunction(e.after_close))?e.after_close:function(){};var f=a("#gritter-notice-wrapper");d(f);f.fadeOut(function(){a(this).remove();c()})},_str_replace:function(q,n,u,c){var g=0,h=0,v="",m="",t=0,e=0,d=[].concat(q),k=[].concat(n),o=u,l=k instanceof Array,p=o instanceof Array;o=[].concat(o);if(c){this.window[c]=0}for(g=0,t=o.length;g<t;g++){if(o[g]===""){continue}for(h=0,e=d.length;h<e;h++){v=o[g]+"";m=l?(k[h]!==undefined?k[h]:""):k[0];o[g]=(v).split(d[h]).join(m);if(c&&o[g]!==v){this.window[c]+=(v.length-o[g].length)/d[h].length}}}return p?o:o[0]},_verifyWrapper:function(){if(a("#gritter-notice-wrapper").length==0){a("body").append(this._tpl_wrap)}}}})(jQuery);