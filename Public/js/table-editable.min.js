var TableEditable=function(){return{init:function(){function e(m,l){var g=m.fnGetData(l);var k=$(">td",l);for(var h=0,j=k.length;h<j;h++){m.fnUpdate(g[h],l,h,false)}m.fnDraw()}function b(j,i){var g=j.fnGetData(i);var h=$(">td",i);h[0].innerHTML='<input type="text" class="m-wrap small" value="'+g[0]+'">';h[1].innerHTML='<input type="text" class="m-wrap small" value="'+g[1]+'">';h[2].innerHTML='<input type="text" class="m-wrap small" value="'+g[2]+'">';h[3].innerHTML='<input type="text" class="m-wrap small" value="'+g[3]+'">';h[4].innerHTML='<a class="edit" href="">Save</a>';h[5].innerHTML='<a class="cancel" href="">Cancel</a>'}function f(i,h){var g=$("input",h);i.fnUpdate(g[0].value,h,0,false);i.fnUpdate(g[1].value,h,1,false);i.fnUpdate(g[2].value,h,2,false);i.fnUpdate(g[3].value,h,3,false);i.fnUpdate('<a class="edit" href="">Edit</a>',h,4,false);i.fnUpdate('<a class="delete" href="">Delete</a>',h,5,false);i.fnDraw()}function a(i,h){var g=$("input",h);i.fnUpdate(g[0].value,h,0,false);i.fnUpdate(g[1].value,h,1,false);i.fnUpdate(g[2].value,h,2,false);i.fnUpdate(g[3].value,h,3,false);i.fnUpdate('<a class="edit" href="">Edit</a>',h,4,false);i.fnDraw()}var d=$("#sample_editable_1").dataTable({aLengthMenu:[[5,15,20,-1],[5,15,20,"All"]],iDisplayLength:5,sDom:"<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span6'i><'span6'p>>",sPaginationType:"bootstrap",oLanguage:{sLengthMenu:"_MENU_   每页显示数量",oPaginate:{sPrevious:"Prev",sNext:"Next"}},aoColumnDefs:[{bSortable:false,aTargets:[0]}]});jQuery("#sample_editable_1_wrapper .dataTables_filter input").addClass("m-wrap medium");jQuery("#sample_editable_1_wrapper .dataTables_length select").addClass("m-wrap small");jQuery("#sample_editable_1_wrapper .dataTables_length select").select2({showSearchInput:false});var c=null;$("#sample_editable_1_new").click(function(h){h.preventDefault();var g=d.fnAddData(["","","","",'<a class="edit" href="">Edit</a>','<a class="cancel" data-mode="new" href="">Cancel</a>']);var i=d.fnGetNodes(g[0]);b(d,i);c=i});$("#sample_editable_1 a.delete").live("click",function(g){g.preventDefault();if(confirm("Are you sure to delete this row ?")==false){return}var h=$(this).parents("tr")[0];d.fnDeleteRow(h);alert("Deleted! Do not forget to do some ajax to sync with backend :)")});$("#sample_editable_1 a.cancel").live("click",function(g){g.preventDefault();if($(this).attr("data-mode")=="new"){var h=$(this).parents("tr")[0];d.fnDeleteRow(h)}else{e(d,c);c=null}});$("#sample_editable_1 a.edit").live("click",function(g){g.preventDefault();var h=$(this).parents("tr")[0];if(c!==null&&c!=h){e(d,c);b(d,h);c=h}else{if(c==h&&this.innerHTML=="Save"){f(d,c);c=null;alert("Updated! Do not forget to do some ajax to sync with backend :)")}else{b(d,h);c=h}}})}}}();