!function(a){var b=function(e){this.value={h:1,s:1,b:1,a:1};this.setColor(e)};b.prototype={constructor:b,setColor:function(f){f=f.toLowerCase();var e=this;a.each(d.stringParsers,function(g,j){var h=j.re.exec(f),l=h&&j.parse(h),k=j.space||"rgba";if(l){if(k==="hsla"){e.value=d.RGBtoHSB.apply(null,d.HSLtoRGB.apply(null,l))}else{e.value=d.RGBtoHSB.apply(null,l)}return false}})},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setLightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt((1-e)*100,10)/100},toRGB:function(k,m,f,e){if(!k){k=this.value.h;m=this.value.s;f=this.value.b}k*=360;var l,j,g,n,i;k=(k%360)/60;i=f*m;n=i*(1-Math.abs(k%2-1));l=j=g=f-i;k=~~k;l+=[i,n,0,0,n,i][k];j+=[n,i,i,n,0,0][k];g+=[0,0,n,i,i,n][k];return{r:Math.round(l*255),g:Math.round(j*255),b:Math.round(g*255),a:e||this.value.a}},toHex:function(g,j,f,e){var i=this.toRGB(g,j,f,e);return"#"+((1<<24)|(parseInt(i.r)<<16)|(parseInt(i.g)<<8)|parseInt(i.b)).toString(16).substr(1)},toHSL:function(g,k,f,e){if(!g){g=this.value.h;k=this.value.s;f=this.value.b}var i=g,j=(2-k)*f,l=k*f;if(j>0&&j<=1){l/=j}else{l/=2-j}j/=2;if(l>1){l=1}return{h:i,s:l,l:j,a:e||this.value.a}}};var c=function(e,g){this.element=a(e);var f=g.format||this.element.data("color-format")||"hex";this.format=d.translateFormats[f];this.isInput=this.element.is("input");this.component=this.element.is(".color")?this.element.find(".add-on"):false;this.picker=a(d.template).appendTo("body").on("mousedown",a.proxy(this.mousedown,this));if(this.isInput){this.element.on({focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this)})}else{if(this.component){this.component.on({click:a.proxy(this.show,this)})}else{this.element.on({click:a.proxy(this.show,this)})}}if(f==="rgba"||f==="hsla"){this.picker.addClass("alpha");this.alpha=this.picker.find(".colorpicker-alpha")[0].style}if(this.component){this.picker.find(".colorpicker-color").hide();this.preview=this.element.find("i")[0].style}else{this.preview=this.picker.find("div:last")[0].style}this.base=this.picker.find("div:first")[0].style;this.update()};c.prototype={constructor:c,show:function(f){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();a(window).on("resize",a.proxy(this.place,this));if(!this.isInput){if(f){f.stopPropagation();f.preventDefault()}}a(document).on({mousedown:a.proxy(this.hide,this)});this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new b(this.isInput?this.element.prop("value"):this.element.data("color"));this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor()},setValue:function(e){this.color=new b(e);this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor();this.element.trigger({type:"changeColor",color:this.color})},hide:function(){this.picker.hide();a(window).off("resize",this.place);if(!this.isInput){a(document).off({mousedown:this.hide});if(this.component){this.element.find("input").prop("value",this.format.call(this))}this.element.data("color",this.format.call(this))}else{this.element.prop("value",this.format.call(this))}this.element.trigger({type:"hide",color:this.color})},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},previewColor:function(){try{this.preview.backgroundColor=this.format.call(this)}catch(f){this.preview.backgroundColor=this.color.toHex()}this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1);if(this.alpha){this.alpha.backgroundColor=this.color.toHex()}},pointer:null,slider:null,mousedown:function(f){f.stopPropagation();f.preventDefault();var h=a(f.target);var i=h.closest("div");if(!i.is(".colorpicker")){if(i.is(".colorpicker-saturation")){this.slider=a.extend({},d.sliders.saturation)}else{if(i.is(".colorpicker-hue")){this.slider=a.extend({},d.sliders.hue)}else{if(i.is(".colorpicker-alpha")){this.slider=a.extend({},d.sliders.alpha)}else{return false}}}var g=i.offset();this.slider.knob=i.find("i")[0].style;this.slider.left=f.pageX-g.left;this.slider.top=f.pageY-g.top;this.pointer={left:f.pageX,top:f.pageY};a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}).trigger("mousemove")}return false},mousemove:function(f){f.stopPropagation();f.preventDefault();var g=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((f.pageX||this.pointer.left)-this.pointer.left)));var h=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((f.pageY||this.pointer.top)-this.pointer.top)));this.slider.knob.left=g+"px";this.slider.knob.top=h+"px";if(this.slider.callLeft){this.color[this.slider.callLeft].call(this.color,g/100)}if(this.slider.callTop){this.color[this.slider.callTop].call(this.color,h/100)}this.previewColor();this.element.trigger({type:"changeColor",color:this.color});return false},mouseup:function(f){f.stopPropagation();f.preventDefault();a(document).off({mousemove:this.mousemove,mouseup:this.mouseup});return false}};a.fn.colorpicker=function(e){return this.each(function(){var f=a(this),g=f.data("colorpicker"),h=typeof e==="object"&&e;if(!g){f.data("colorpicker",(g=new c(this,a.extend({},a.fn.colorpicker.defaults,h))))}if(typeof e==="string"){g[e]()}})};a.fn.colorpicker.defaults={};a.fn.colorpicker.Constructor=c;var d={translateFormats:{rgb:function(){var e=this.color.toRGB();return"rgb("+e.r+","+e.g+","+e.b+")"},rgba:function(){var e=this.color.toRGB();return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},hsl:function(){var e=this.color.toHSL();return"hsl("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%)"},hsla:function(){var e=this.color.toHSL();return"hsla("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%,"+e.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setAlpha"}},RGBtoHSB:function(k,i,f,e){k/=255;i/=255;f/=255;var j,l,m,h;m=Math.max(k,i,f);h=m-Math.min(k,i,f);j=(h===0?null:m==k?(i-f)/h:m==i?(f-k)/h+2:(k-i)/h+4);j=((j+360)%6)*60/360;l=h===0?0:h/m;return{h:j||1,s:l,b:m,a:e||1}},HueToRGB:function(f,g,e){if(e<0){e+=1}else{if(e>1){e-=1}}if((e*6)<1){return f+(g-f)*e*6}else{if((e*2)<1){return g}else{if((e*3)<2){return f+(g-f)*((2/3)-e)*6}else{return f}}}},HSLtoRGB:function(j,t,k,e){if(t<0){t=0}var n;if(k<=0.5){n=k*(1+t)}else{n=k+t-(k*t)}var m=2*k-n;var w=j+(1/3);var v=j;var u=j-(1/3);var o=Math.round(d.HueToRGB(m,n,w)*255);var i=Math.round(d.HueToRGB(m,n,v)*255);var f=Math.round(d.HueToRGB(m,n,u)*255);return[o,i,f,e||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}}],template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>'}}(window.jQuery);