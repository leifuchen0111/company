!function(a){var d="<img src='assets/plugins/bootstrap-tree/bootstrap-tree/img/ajax-loader.gif' class='indicator' /> Loading ...";var g=function(h,i){this.$element=a(h);this.$tree=this.$element.closest(".tree");this.parentage=b(this.$element);this.options=a.extend({},a.fn.tree.defaults,i);if(this.options.parent){this.$parent=a(this.options.parent)}this.options.toggle&&this.toggle()};g.prototype={constructor:g,toggle:function(){var h,k,l,i=this.$element.hasClass("in"),j=(!i)?"openbranch":"closebranch";this.$parent[i?"addClass":"removeClass"]("closed");this.$element[i?"removeClass":"addClass"]("in");if(this.options.href){this._load()}k=this.node();h=a.Event(j,{node:k});l=a.Event("nodeselect",{node:k});this.$parent.trigger(h).trigger(l)},_load:function(){var i=a.extend({},this.options),j=this.$element,h=a(this),k=this.options;delete i.parent;delete i.href;delete i.callback;a.post(k.href,i,function(m,p,r){var n,q="html";if(k.callback){var l=window[k.callback].apply(j,[m,p,r]);n=l.doc||m;q=l.type||q}else{try{n=a.parseJSON(m);q="json"}catch(o){n=m}if(q!=="json"){try{n=a.parseXML(m);q="xml"}catch(o){n=m}}}switch(q){case"html":j.html(n);break;default:h[0]._buildOutput(n,q,j);break}},"html")},_buildOutput:function(h,k,j){var i=this._buildNodes(h,k);j.empty().append(this._createNodes(i))},_createNodes:function(j){var i=[],h=a(this);a.each(j,function(o,n){var q=a("<li>"),r=(n.leaf)?"leaf":"branch",l={},k=a("<a>");l.role=r;if(!n.leaf){var m=a("<ul>").addClass("branch");l["class"]="tree-toggle closed";l["data-toggle"]="branch"}if(n.value){l["data-value"]=n.value}if(n.id){l["data-itemid"]=n.id}for(var p in n){if(p.indexOf("data-")!==-1){l[p]=n[p]}}l.href=(n.href)?n.href:"#";if(n.leaf&&l.href==="#"){k=a("<span>");delete l.href}k.attr(l);if(n.cls){k.addClass(n.cls)}if(!n.leaf&&n.expanded&&n.children.length){k.removeClass("closed");m.addClass("in")}k.html(n.text);q.append(k);if(!n.leaf&&n.children&&n.children.length){m.append(h[0]._createNodes(n.children));q.append(m)}i.push(q)});return i},_buildNodes:function(i,k){var j=[],h=this.$element;if(k==="json"){j=this._parseJsonNodes(i)}else{if(k==="xml"){j=this._parseXmlNodes(a(i).find("nodes").children())}}return j},_parseJsonNodes:function(i){var j=[],h=a(this);a.each(i,function(m,l){var p={},k=["leaf","expanded","checkable","checked"];for(var n in l){var o=(n!=="children")?l[n]:h[0]._parseJsonNodes(l.children);if(!a.isArray(o)){o=a.trim(o)}if(o.length){p[n]=(a.inArray(n,k)>-1)?f(o):o}}j.push(new e(p))});return j},_parseXmlNodes:function(j){var k=[],h=a(this),i=["leaf","expanded","checkable","checked"];a.each(j,function(n,m){var o={},l=a(m);a.each(l.children(),function(t,q){var p=a(q),s=p[0].nodeName,r=(s!=="children")?p.text():h[0]._parseXmlNodes(p.children("node"));if(!a.isArray(r)){r=a.trim(r)}if(r.length){o[s]=(a.inArray(s,i)>-1)?f(r):r}});k.push(new e(o))});return k},getparentage:function(){return this.parentage},node:function(h){h=h||a(this);var i=a.extend(true,{},(h[0]===a(this)[0])?a(this.$parent).data():h.data());i.branch=this.$element;i.parentage=this.parentage;i.el=(h[0]===a(this)[0])?this.$parent:h;delete i.parent;return i}};var e=function(h){a.extend(true,this,{text:undefined,leaf:false,value:undefined,expanded:false,cls:undefined,id:undefined,href:undefined,checkable:false,checked:false,children:[]},h)};var c=function(h){return h.closest("ul.branch").prev(".tree-toggle")};var b=function(h){var i=[],j;j=c(h);if(j.length){i=b(j);i.push(j.attr("data-value")||j.text())}return i};var f=function(h){h=a.trim(h);if(typeof h==="undefined"||h===null){return false}if(typeof h==="string"&&!isNaN(h)){h=parseFloat(h)}if(typeof h==="string"){switch(h.toLowerCase()){case"true":case"yes":return true;case"false":case"no":return false}}return Boolean(h)};a.fn.tree=function(h){return this.each(function(){var i=a(this),j=i.data("tree"),k=typeof h=="object"&&h;if(!j){i.data("tree",(j=new g(this,k)))}if(typeof h=="string"){j[h]()}})};a.fn.tree.defaults={toggle:true};a.fn.tree.Constructor=g;a(function(){a("body").on("click.tree.data-api","[data-toggle=branch]",function(i){i.preventDefault();var h=a(this),l=h.next(".branch"),j=h.attr("href"),k=a(l).data("tree")?"toggle":h.data();j.replace(/.*(?=#[^\s]+$)/,"");if(!l.length){l=a("<ul>").addClass("branch").append("<li>"+d+"</li>").insertAfter(h)}k.parent=h;k.href=(j!=="#")?j:undefined;a(l).tree(k);return false});a("body").on("click.tree.data-api","[data-role=leaf]",function(m){var i=a(this),j=i.closest(".branch");if(!a(j).data("tree")){var h=a(j),l=h.prev("[data-toggle=branch]"),k=l.data(),n=l.attr("href");n.replace(/.*(?=#[^\s]+$)/,"");h.tree(a.extend({},k,{toggle:false,parent:l,href:(n!=="#")?n:undefined}))}m=a.Event("nodeselect",{node:a(j).data("tree").node(i)});i.trigger(m)})})}(window.jQuery);