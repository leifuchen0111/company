!function(a){var b=function(c,d){this.$element=a(c);this.options=a.extend({},a.fn.timepicker.defaults,d,this.$element.data());this.minuteStep=this.options.minuteStep||this.minuteStep;this.secondStep=this.options.secondStep||this.secondStep;this.showMeridian=this.options.showMeridian||this.showMeridian;this.showSeconds=this.options.showSeconds||this.showSeconds;this.showInputs=this.options.showInputs||this.showInputs;this.disableFocus=this.options.disableFocus||this.disableFocus;this.template=this.options.template||this.template;this.modalBackdrop=this.options.modalBackdrop||this.modalBackdrop;this.defaultTime=this.options.defaultTime||this.defaultTime;this.open=false;this.init()};b.prototype={constructor:b,init:function(){if(this.$element.parent().hasClass("input-append")){this.$element.parent(".input-append").find(".add-on").on("click",a.proxy(this.showWidget,this));this.$element.on({focus:a.proxy(this.highlightUnit,this),click:a.proxy(this.highlightUnit,this),keypress:a.proxy(this.elementKeypress,this),blur:a.proxy(this.blurElement,this)})}else{if(this.template){this.$element.on({focus:a.proxy(this.showWidget,this),click:a.proxy(this.showWidget,this),blur:a.proxy(this.blurElement,this)})}else{this.$element.on({focus:a.proxy(this.highlightUnit,this),click:a.proxy(this.highlightUnit,this),keypress:a.proxy(this.elementKeypress,this),blur:a.proxy(this.blurElement,this)})}}this.$widget=a(this.getTemplate()).appendTo("body");this.$widget.on("click",a.proxy(this.widgetClick,this));if(this.showInputs){this.$widget.find("input").on({click:function(){this.select()},keypress:a.proxy(this.widgetKeypress,this),change:a.proxy(this.updateFromWidgetInputs,this)})}this.setDefaultTime(this.defaultTime)},showWidget:function(c){c.stopPropagation();c.preventDefault();if(this.open){return}this.$element.trigger("show");if(this.disableFocus){this.$element.blur()}var d=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.updateFromElementVal();a("html").trigger("click.timepicker.data-api").one("click.timepicker.data-api",a.proxy(this.hideWidget,this));if(this.template==="modal"){this.$widget.modal("show").on("hidden",a.proxy(this.hideWidget,this))}else{this.$widget.css({top:d.top+d.height,left:d.left});if(!this.open){this.$widget.addClass("open")}}this.open=true;this.$element.trigger("shown")},hideWidget:function(){this.$element.trigger("hide");if(this.template==="modal"){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}this.open=false;this.$element.trigger("hidden")},widgetClick:function(d){d.stopPropagation();d.preventDefault();var c=a(d.target).closest("a").data("action");if(c){this[c]();this.update()}},widgetKeypress:function(c){var d=a(c.target).closest("input").attr("name");switch(c.keyCode){case 9:if(this.showMeridian){if(d=="meridian"){this.hideWidget()}}else{if(this.showSeconds){if(d=="second"){this.hideWidget()}}else{if(d=="minute"){this.hideWidget()}}}break;case 27:this.hideWidget();break;case 38:switch(d){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break;case 40:switch(d){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break}},elementKeypress:function(c){var d=this.$element.get(0);switch(c.keyCode){case 0:break;case 9:this.updateFromElementVal();if(this.showMeridian){if(this.highlightedUnit!="meridian"){c.preventDefault();this.highlightNextUnit()}}else{if(this.showSeconds){if(this.highlightedUnit!="second"){c.preventDefault();this.highlightNextUnit()}}else{if(this.highlightedUnit!="minute"){c.preventDefault();this.highlightNextUnit()}}}break;case 27:this.updateFromElementVal();break;case 37:this.updateFromElementVal();this.highlightPrevUnit();break;case 38:switch(this.highlightedUnit){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break;case 39:this.updateFromElementVal();this.highlightNextUnit();break;case 40:switch(this.highlightedUnit){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break}if(c.keyCode!==0&&c.keyCode!==8&&c.keyCode!==9&&c.keyCode!==46){c.preventDefault()}},setValues:function(d){if(this.showMeridian){var c=d.split(" ");var e=c[0].split(":");this.meridian=c[1]}else{var e=d.split(":")}this.hour=parseInt(e[0],10);this.minute=parseInt(e[1],10);this.second=parseInt(e[2],10);if(isNaN(this.hour)){this.hour=0}if(isNaN(this.minute)){this.minute=0}if(this.showMeridian){if(this.hour>12){this.hour=12}else{if(this.hour<1){this.hour=1}}if(this.meridian=="am"||this.meridian=="a"){this.meridian="AM"}else{if(this.meridian=="pm"||this.meridian=="p"){this.meridian="PM"}}if(this.meridian!="AM"&&this.meridian!="PM"){this.meridian="AM"}}else{if(this.hour>=24){this.hour=23}else{if(this.hour<0){this.hour=0}}}if(this.minute<0){this.minute=0}else{if(this.minute>=60){this.minute=59}}if(this.showSeconds){if(isNaN(this.second)){this.second=0}else{if(this.second<0){this.second=0}else{if(this.second>=60){this.second=59}}}}if(this.$element.val()!=""){this.updateElement()}this.updateWidget()},setMeridian:function(c){if(c=="a"||c=="am"||c=="AM"){this.meridian="AM"}else{if(c=="p"||c=="pm"||c=="PM"){this.meridian="PM"}else{this.updateWidget()}}this.updateElement()},setDefaultTime:function(c){if(c){if(c==="current"){var d=new Date();var e=d.getHours();var g=Math.floor(d.getMinutes()/this.minuteStep)*this.minuteStep;var h=Math.floor(d.getSeconds()/this.secondStep)*this.secondStep;var f="AM";if(this.showMeridian){if(e===0){e=12}else{if(e>=12){if(e>12){e=e-12}f="PM"}else{f="AM"}}}this.hour=e;this.minute=g;this.second=h;this.meridian=f}else{if(c==="value"){this.setValues(this.$element.val())}else{this.setValues(c)}}if(this.$element.val()!=""){this.updateElement()}this.updateWidget()}else{this.hour=0;this.minute=0;this.second=0}},formatTime:function(c,e,f,d){c=c<10?"0"+c:c;e=e<10?"0"+e:e;f=f<10?"0"+f:f;return c+":"+e+(this.showSeconds?":"+f:"")+(this.showMeridian?" "+d:"")},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},setTime:function(c){this.setValues(c);this.update()},update:function(){this.updateElement();this.updateWidget()},blurElement:function(){this.highlightedUnit=undefined;this.updateFromElementVal()},updateElement:function(){var c=this.getTime();this.$element.val(c).change();switch(this.highlightedUnit){case"hour":this.highlightHour();break;case"minute":this.highlightMinute();break;case"second":this.highlightSecond();break;case"meridian":this.highlightMeridian();break}},updateWidget:function(){if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(this.hour<10?"0"+this.hour:this.hour);this.$widget.find("input.bootstrap-timepicker-minute").val(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(this.hour);this.$widget.find("span.bootstrap-timepicker-minute").text(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromElementVal:function(c){var d=this.$element.val();if(d){this.setValues(d);this.updateWidget()}},updateFromWidgetInputs:function(){var c=a("input.bootstrap-timepicker-hour",this.$widget).val()+":"+a("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+a("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+a("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setValues(c)},getCursorPosition:function(){var c=this.$element.get(0);if("selectionStart" in c){return c.selectionStart}else{if(document.selection){c.focus();var d=document.selection.createRange();var e=document.selection.createRange().text.length;d.moveStart("character",-c.value.length);return d.text.length-e}}},highlightUnit:function(){var c=this.$element.get(0);this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}break;case"second":this.highlightMeridian();break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){this.highlightedUnit="hour";this.$element.get(0).setSelectionRange(0,2)},highlightMinute:function(){this.highlightedUnit="minute";this.$element.get(0).setSelectionRange(3,5)},highlightSecond:function(){this.highlightedUnit="second";this.$element.get(0).setSelectionRange(6,8)},highlightMeridian:function(){this.highlightedUnit="meridian";if(this.showSeconds){this.$element.get(0).setSelectionRange(9,11)}else{this.$element.get(0).setSelectionRange(6,8)}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.toggleMeridian()}else{if(this.hour===12){return this.hour=1}}}if(this.hour===23){return this.hour=0}this.hour=this.hour+1},decrementHour:function(){if(this.showMeridian){if(this.hour===1){return this.hour=12}else{if(this.hour===12){this.toggleMeridian()}}}if(this.hour===0){return this.hour=23}this.hour=this.hour-1},incrementMinute:function(){var c=this.minute+this.minuteStep-(this.minute%this.minuteStep);if(c>59){this.incrementHour();this.minute=c-60}else{this.minute=c}},decrementMinute:function(){var c=this.minute-this.minuteStep;if(c<0){this.decrementHour();this.minute=c+60}else{this.minute=c}},incrementSecond:function(){var c=this.second+this.secondStep-(this.second%this.secondStep);if(c>59){this.incrementMinute();this.second=c-60}else{this.second=c}},decrementSecond:function(){var c=this.second-this.secondStep;if(c<0){this.decrementMinute();this.second=c+60}else{this.second=c}},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM";this.update()},getTemplate:function(){if(this.options.templates[this.options.template]){return this.options.templates[this.options.template]}if(this.showInputs){var c='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>';var e='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>';var f='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>';var d='<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>'}else{var c='<span class="bootstrap-timepicker-hour"></span>';var e='<span class="bootstrap-timepicker-minute"></span>';var f='<span class="bootstrap-timepicker-second"></span>';var d='<span class="bootstrap-timepicker-meridian"></span>'}var h='<table class="'+(this.showSeconds?"show-seconds":"")+" "+(this.showMeridian?"show-meridian":"")+'"><tr><td><a href="#" data-action="incrementHour"><i class="icon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="icon-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="icon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+c+'</td> <td class="separator">:</td><td>'+e+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+f+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+d+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="icon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="icon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="icon-chevron-down"></i></a></td>':"")+"</tr></table>";var g;switch(this.options.template){case"modal":g='<div class="bootstrap-timepicker modal hide fade in" style="top: 30%; margin-top: 0; width: 200px; margin-left: -100px;" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">×</a><h3>Pick a Time</h3></div><div class="modal-content">'+h+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a></div></div>';break;case"dropdown":g='<div class="bootstrap-timepicker dropdown-menu">'+h+"</div>";break}return g}};a.fn.timepicker=function(c){return this.each(function(){var d=a(this),e=d.data("timepicker"),f=typeof c=="object"&&c;if(!e){d.data("timepicker",(e=new b(this,f)))}if(typeof c=="string"){e[c]()}})};a.fn.timepicker.defaults={minuteStep:15,secondStep:15,disableFocus:false,defaultTime:"current",showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",modalBackdrop:false,templates:{}};a.fn.timepicker.Constructor=b}(window.jQuery);